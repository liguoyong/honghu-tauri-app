tinymce.PluginManager.add('customTitle', function(editor, url) {
  editor.ui.registry.addButton('addTitle', {
      text: 'tips',
      onAction: function () {
          const selectedContent = editor.selection.getContent();
          if (selectedContent) {
              editor.windowManager.open({
                  title: '添加title',
                  body: {
                      type: 'panel',
                      items: [
                          {
                              name: 'title',
                              // type: 'input',
                              type: 'textarea',
                              label: ''
                          }
                      ]
                  },
                  buttons: [
                      {
                          type: 'cancel',
                          text: 'Cancel'
                      },
                      {
                          type: 'submit',
                          text: 'OK'
                      }
                  ],
                  onSubmit: function (api) {
                      const data = api.getData();
                      if (data.title) {
                          editor.insertContent(`<span title="${data.title}">${selectedContent}</span>`);
                      }
                      api.close();
                  }
              });
          } else {
              editor.windowManager.alert('Please select some text or an image first.');
          }
      }
  });

  editor.ui.registry.addButton('addImageTitle', {
      text: 'Add Image Title',
      onAction: function () {
          const selectedNode = editor.selection.getNode();
          if (selectedNode.nodeName === 'IMG') {
              editor.windowManager.open({
                  title: 'Enter Image Title',
                  body: {
                      type: 'panel',
                      items: [
                          {
                              name: 'title',
                              type: 'input',
                              label: 'Image Title'
                          }
                      ]
                  },
                  buttons: [
                      {
                          type: 'cancel',
                          text: 'Cancel'
                      },
                      {
                          type: 'submit',
                          text: 'OK'
                      }
                  ],
                  onSubmit: function (api) {
                      const data = api.getData();
                      if (data.title) {
                          editor.dom.setAttrib(selectedNode, 'title', data.title);
                      }
                      api.close();
                  }
              });
          } else {
              editor.windowManager.alert('Please select an image first.');
          }
      }
  });
});